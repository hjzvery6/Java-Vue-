{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport request from \"@/utils/request\";\nexport default {\n  data() {\n    let goodsId = this.$route.query.id;\n    return {\n      user: JSON.parse(localStorage.getItem(\"user\") || {}),\n      goods: {},\n      goodsId: goodsId,\n      buyNum: 1,\n      comments: [],\n      addressList: [],\n      dialogVisible: false,\n      num: 1,\n      content: '',\n      praiseCheck: false,\n      addressId: null,\n      carousel_1_1: [require(\"@/assets/imgs/dapai.png\")]\n    };\n  },\n  mounted() {\n    this.load();\n    this.loadComment();\n    this.checkPraise();\n    this.loadAddress();\n  },\n  // methods：本页面所有的点击事件或者其他函数定义区\n  methods: {\n    load() {\n      request.get('/goods/' + this.goodsId).then(res => {\n        this.goods = res.data;\n      });\n    },\n    loadComment() {\n      request.get(\"/comment/\" + this.goodsId).then(res => {\n        if (res.code === '0') {\n          this.comments = res.data;\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    loadAddress() {\n      request.get(\"/address\").then(res => {\n        if (res.code === '0') {\n          this.addressList = res.data;\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    buy() {\n      this.dialogVisible = true;\n    },\n    save() {\n      if (!this.user && !this.user.username) {\n        this.$notify.error(\"登录失效，请重新登陆\");\n        this.$router.push(\"/login\");\n        return;\n      }\n      if (this.user.role === 1) {\n        this.$notify.warning(\"您是管理员，不支持该操作\");\n        return;\n      }\n      if (!this.addressId) {\n        this.$notify.warning(\"请选择收货地址,如没有地址，请到地址管理设置地址\");\n        return;\n      }\n      this.goods.userId = this.user.id;\n      this.goods.goodsId = this.goods.id;\n      this.goods.addressId = this.addressId;\n      this.goods.num = this.num;\n      this.goods.id = null;\n      request.post(\"/order/buy/one\", this.goods).then(res => {\n        if (res.code === '0') {\n          this.$notify.success(\"购买成功\");\n          this.$router.push(\"/front/order\");\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    addCart() {\n      if (!this.user && !this.user.username) {\n        this.$notify.error(\"登录失效，请重新登陆\");\n        this.$router.push(\"/login\");\n        return;\n      }\n      if (this.user.role === 1) {\n        this.$notify.warning(\"您是管理员，不支持该操作\");\n        return;\n      }\n      let data = {\n        userId: this.user.id,\n        goodsId: this.goods.id,\n        num: this.num\n      };\n      request.post(\"/cart\", data).then(res => {\n        if (res.code === '0') {\n          this.$notify.success(\"加入成功\");\n          this.$router.push(\"/front/cart\");\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    submit(parentId, content) {\n      if (!content) {\n        this.$notify.warning(\"请输入内容\");\n      }\n      let data = {\n        content: content,\n        userId: this.user.id,\n        role: this.user.role,\n        parentId: parentId,\n        relId: this.goodsId\n      };\n      request.post(\"/comment\", data).then(res => {\n        if (res.code === '0') {\n          this.$notify.success(\"评论成功\");\n          this.loadComment();\n          this.content = \"\";\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    checkPraise() {\n      request.get(\"/goods/praise/check/\" + this.goodsId).then(res => {\n        if (res.code === '0') {\n          this.praiseCheck = res.data;\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    praise() {\n      request.get(\"/goods/praise/\" + this.goodsId).then(res => {\n        if (res.code === '0') {\n          this.checkPraise();\n          this.load();\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["request","data","goodsId","$route","query","id","user","JSON","parse","localStorage","getItem","goods","buyNum","comments","addressList","dialogVisible","num","content","praiseCheck","addressId","carousel_1_1","require","mounted","load","loadComment","checkPraise","loadAddress","methods","get","then","res","code","$notify","error","msg","buy","save","username","$router","push","role","warning","userId","post","success","addCart","submit","parentId","relId","praise"],"sources":["src/views/front/Detail.vue"],"sourcesContent":["<!-- 商城推荐系统/点击某商品后的详情页面 -->\n<template>\n  <div class=\"detail-container\">\n    <div class=\"detail-title\">详情信息</div>\n\n    <div class=\"detail-content\">\n      <div class=\"detail-left-img-fields\">\n        <!-- 商品图片 -->\n        <div style=\"flex: 1;\"><img :src=\"goods.img\" style=\"width: 100%; height: 440px; margin-top: 10px; border-radius: 5px; border: #e3e3e3 solid 1px\"></div>\n\n        <div style=\"flex: 2; margin-left: 50px\">\n          <!-- 商品名 -->\n          <div class=\"detail-fields-item overflowShow\" style=\"font-size: 18px;color:#000000;font-weight: 550;\">{{goods.name}}</div>\n          \n          <!-- 商品价格(就是有现价和原价的那一格) -->\n          <div class=\"detail-fields-item overflowShow\" style=\"font-size: 18px;color:#000000;font-weight: 550;background-color:#365ec2;color:white;width: 500px;height: 100px;\n          text-align: left;line-height: 100px;padding: 0 20px\">\n            <div style=\"width: 500px;height: 100px;display:flex;text-align: left;align-items: center;\">\n              <span style=\"font-size: 20px\">￥</span>\n              <span style=\"font-size: 40px\">{{goods.price}}</span>\n              <span style=\"font-size: 20px;margin-left: 10px;font-weight: lighter;text-decoration: line-through\">￥{{goods.originalprice}}</span>\n            </div>\n          </div>\n\n          <!-- 商品地区 -->\n          <div class=\"detail-fields-item overflowShow\">\n            <span style=\"font-size: 12px;color: #8c8a8a; margin-right: 10px\">商品地区</span>\n            <span style=\"font-size: 13px;color: #2f2e2e\">{{goods.location}}</span>\n          </div>\n          <!-- 商品型号 -->\n          <div class=\"detail-fields-item overflowShow\">\n            <span style=\"font-size: 12px;color: #8c8a8a; margin-right: 10px\">商品型号</span>\n            <span style=\"font-size: 13px;color: #2f2e2e\">{{goods.goodsmodel}}</span>\n          </div>\n          <!-- 商品运费 -->\n          <div class=\"detail-fields-item overflowShow\">\n            <span style=\"font-size: 12px;color: #8c8a8a; margin-right: 10px\">商品运费</span>\n            <span style=\"font-size: 13px;color: #2f2e2e\">新用户专享首单满38元免邮（部分商品不可用）</span>\n          </div>\n          <!-- 点个赞吧 -->\n          <div class=\"detail-fields-item overflowShow\" style=\"display: flex;\">\n            <div style=\"font-size: 12px;color: #8c8a8a; margin-right: 10px;text-align: center;line-height: 20px\">点个赞吧</div>\n            <img src=\"@/assets/imgs/点赞-active.png\" v-if=\"praiseCheck\" alt=\"\" style=\"margin-right: 10px; width: 20px\" @click=\"praise()\">\n            <img src=\"@/assets/imgs/点赞.png\" v-else alt=\"\" style=\"margin-right: 10px; width: 20px\" @click=\"praise\">\n            <div style=\"font-size: 13px;color: #8c8a8a;text-align: center;line-height: 20px\">{{goods.praise}}</div>\n          </div>\n          <!-- 购买数量选择 -->\n          <div class=\"detail-fields-item overflowShow\">\n            <span style=\"font-size: 12px;color: #8c8a8a;  margin-right: 10px\">购买数量</span>\n            <el-input-number :value=\"1\" size=\"small\" style=\"width: 100px;\" v-model=\"num\"></el-input-number>\n          </div>\n          <!-- 加入购物车和支付 -->\n          <div class=\"detail-fields-item overflowShow\" style=\"margin-top: 50px\">\n            <el-button style=\"margin-left: 5px; width: 200px;height: 60px;background-color: #7ab3f5;color: white;margin-right: 0;border:none;border-radius: 0;\" @click=\"addCart\">\n              <span style=\"font-size:16px;\">加入购物车</span>\n            </el-button>\n            <el-button style=\"width: 200px;height: 60px;background-color: #365ec2;color: white;margin-left: -2px; border:none;border-radius: 0;\" @click=\"buy\">\n              <span style=\"font-size:16px;\">支付</span>\n            </el-button>\n          </div>\n        </div>\n      </div>\n\n      <!-- 商品详情下面的广告部分   -->\n      <div class=\"detail-richtext\">\n        <!-- 商品名称 -->\n        <div class=\"detail-richtext-title\">{{goods.name}}</div>\n        <!-- 商品描述 -->\n        <div class=\"detail-richtext-content w-e-text\" v-html=\"goods.description\"></div>\n      </div>\n    </div>\n\n    <!-- 评论信息 -->\n    <div class=\"detail-title\">评论信息</div>\n    <div class=\"detail-comment\">\n      <div>\n        <el-row v-for=\"item in comments\" style=\"margin-bottom: 10px\">\n          <el-col :span=\"4\" style=\"display: flex; align-items: center;\">\n            <!-- 评论人头像 -->\n            <img :src=\"item.avatar\" style=\"width: 50px; height: 50px; border-radius: 50%;\">\n            <!-- 评论人用户名 -->\n            <div style=\"margin-left: 10px; flex: 1\" class=\"overflowShow\">{{item.userName}}</div>\n          </el-col>\n          <el-col :span=\"20\">\n            <el-row>\n              <!-- 评论内容 -->\n              <el-col :span=\"20\" style=\"height: 50px; line-height: 50px\">{{item.content}}</el-col>\n              <!-- 评论时间 -->\n              <el-col :span=\"4\" style=\"height: 50px; line-height: 50px; text-align: right\">{{item.time}}</el-col>\n            </el-row>\n            <!-- 这条评论的子评论 -->\n            <el-row :span=\"3\" style=\"margin-top: 20px\" v-for=\"child in item.children\">\n              <el-col :span=\"4\" style=\"display: flex; align-items: center;\">\n                <!-- 子评论人用户名 -->\n                <img :src=\"child.avatar\" style=\"width: 50px; height: 50px; border-radius: 50%;\">\n                <!-- 子评论人头像 -->\n                <div style=\"margin-left: 10px; flex: 1\" class=\"overflowShow\">{{child.userName}} 回复：</div>\n              </el-col>\n              <!-- 子评论内容 -->\n              <el-col :span=\"16\" style=\"height: 50px; line-height: 50px\">{{child.content}}</el-col>\n              <!-- 子评论时间 -->\n              <el-col :span=\"4\" style=\"height: 50px; line-height: 50px; text-align: right\">{{child.time}}</el-col>\n            </el-row>\n            <!-- 回复框 -->\n            <el-row :span=\"3\" style=\"margin-top: 20px\">\n              <el-col :span=\"15\">\n                <!-- 输入评论 -->\n                <el-input v-model=\"item.reply\"></el-input>\n              </el-col>\n              <el-col :span=\"4\" style=\"margin-left: 10px\">\n                <!-- 回复按钮 -->\n                <el-button type=\"primary\" @click=\"submit(item.id, item.reply)\">回复</el-button>\n              </el-col>\n            </el-row>\n          </el-col>\n        </el-row>\n      </div>\n    </div>\n\n    <!-- 支付对话框 -->\n    <el-dialog title=\"请选择收货地址\" :visible.sync=\"dialogVisible\" width=\"40%\">\n      <el-form :model=\"goods\" label-position=\"right\" label-width=\"100px\" style=\"padding-right: 40px\">\n        <!-- 收货人 -->\n        <el-form-item>\n          <span style=\"font-size: 12px;color: #8c8a8a;  margin-right: 10px\">收货人</span>\n          <el-select size=\"small\" style=\"width: 80%\" placeholder=\"请选择收货人\" v-model=\"addressId\">\n            <el-option v-for=\"item in addressList\" :value=\"item.id\" :label=\"item.username\" :key=\"item.id\"></el-option>\n          </el-select>\n        </el-form-item>\n        <!-- 收货地址 -->\n        <el-form-item>\n          <span style=\"font-size: 12px;color: #8c8a8a;  margin-right: 10px\">收货地址</span>\n          <el-select size=\"small\" style=\"width: 80%\" placeholder=\"请选择收货地址\" v-model=\"addressId\">\n            <el-option v-for=\"item in addressList\" :value=\"item.id\" :label=\"item.address\" :key=\"item.id\"></el-option>\n          </el-select>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button size=\"small\" @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button size=\"small\"  @click=\"save\" style=\"background-color: #8f5b95; color: white;\">支 付</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport request from \"@/utils/request\";\n\nexport default {\n\n  data() {\n    let goodsId = this.$route.query.id\n    return {\n      user: JSON.parse(localStorage.getItem(\"user\") || {}),\n      goods: {},\n      goodsId: goodsId,\n      buyNum: 1,\n      comments: [],\n      addressList: [],\n      dialogVisible: false,\n      num: 1,\n      content: '',\n      praiseCheck: false,\n      addressId: null,\n      carousel_1_1: [\n          require(\"@/assets/imgs/dapai.png\")\n      ],\n\n    }\n  },\n  mounted() {\n    this.load()\n    this.loadComment()\n    this.checkPraise()\n    this.loadAddress()\n  },\n  // methods：本页面所有的点击事件或者其他函数定义区\n  methods: {\n    load() {\n      request.get('/goods/' + this.goodsId).then(res => {\n        this.goods = res.data\n      })\n    },\n    loadComment() {\n      request.get(\"/comment/\" + this.goodsId).then(res => {\n        if (res.code === '0') {\n          this.comments = res.data\n        } else {\n          this.$notify.error(res.msg)\n        }\n      })\n    },\n    loadAddress(){\n      request.get(\"/address\").then(res => {\n        if (res.code === '0') {\n          this.addressList = res.data\n        } else {\n          this.$notify.error(res.msg)\n        }\n      })\n    },\n    buy() {\n      this.dialogVisible = true;\n    },\n    save() {\n      if (!this.user && !this.user.username) {\n        this.$notify.error(\"登录失效，请重新登陆\")\n        this.$router.push(\"/login\")\n        return;\n      }\n      if (this.user.role === 1) {\n        this.$notify.warning(\"您是管理员，不支持该操作\")\n        return;\n      }\n      if (!this.addressId) {\n        this.$notify.warning(\"请选择收货地址,如没有地址，请到地址管理设置地址\")\n        return\n      }\n      this.goods.userId = this.user.id;\n      this.goods.goodsId = this.goods.id;\n      this.goods.addressId = this.addressId;\n      this.goods.num = this.num;\n      this.goods.id = null;\n      request.post(\"/order/buy/one\", this.goods).then(res => {\n        if (res.code === '0') {\n          this.$notify.success(\"购买成功\")\n          this.$router.push(\"/front/order\")\n        } else {\n          this.$notify.error(res.msg)\n        }\n      })\n    },\n    addCart() {\n      if (!this.user && !this.user.username) {\n        this.$notify.error(\"登录失效，请重新登陆\")\n        this.$router.push(\"/login\")\n        return;\n      }\n      if (this.user.role === 1) {\n        this.$notify.warning(\"您是管理员，不支持该操作\")\n        return;\n      }\n      let data = {\n        userId: this.user.id,\n        goodsId: this.goods.id,\n        num: this.num,\n      }\n      request.post(\"/cart\", data).then(res => {\n        if (res.code === '0') {\n          this.$notify.success(\"加入成功\")\n          this.$router.push(\"/front/cart\")\n        } else {\n          this.$notify.error(res.msg)\n        }\n      })\n    },\n    submit(parentId, content) {\n      if (!content) {\n        this.$notify.warning(\"请输入内容\")\n      }\n      let data = {content: content, userId: this.user.id, role: this.user.role, parentId: parentId, relId: this.goodsId}\n      request.post(\"/comment\", data).then(res => {\n        if (res.code ==='0') {\n          this.$notify.success(\"评论成功\")\n          this.loadComment()\n          this.content = \"\"\n        } else {\n          this.$notify.error(res.msg)\n        }\n      })\n    },\n    checkPraise() {\n      request.get(\"/goods/praise/check/\" + this.goodsId).then(res => {\n        if (res.code === '0') {\n          this.praiseCheck = res.data\n        } else {\n          this.$notify.error(res.msg)\n        }\n      })\n    },\n    praise() {\n      request.get(\"/goods/praise/\" + this.goodsId).then(res => {\n        if (res.code === '0') {\n          this.checkPraise();\n          this.load();\n        } else {\n          this.$notify.error(res.msg)\n        }\n      })\n    }\n  }\n}\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}