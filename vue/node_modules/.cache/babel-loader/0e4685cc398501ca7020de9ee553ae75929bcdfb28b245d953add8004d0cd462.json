{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport request from \"@/utils/request\";\nexport default {\n  data() {\n    let goodsId = this.$route.query.id; // 从当前路由的查询参数中获取id并赋值\n    return {\n      user: JSON.parse(localStorage.getItem(\"user\") || {}),\n      cartData: [],\n      // 购物车表格数据\n      goods: {},\n      goodsId: goodsId,\n      addressList: [],\n      dialogVisible: false,\n      // 对话框是否可见\n      addressId: null\n    };\n  },\n  // 加载时做的事情\n  mounted() {\n    this.load();\n    this.loadAddress();\n  },\n  // methods：本页面所有的点击事件或者其他函数定义区\n  methods: {\n    // 加载数据\n    load() {\n      request.get(\"/cart\").then(res => {\n        if (res.code === '0') {\n          this.cartData = res.data;\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    // 根据id删除\n    del(id) {\n      request.delete(\"/cart/\" + id).then(res => {\n        if (res.code === '0') {\n          this.$notify.success(\"删除成功\");\n          this.load();\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    loadAddress() {\n      request.get(\"/address\").then(res => {\n        if (res.code === '0') {\n          this.addressList = res.data;\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    },\n    buy() {\n      this.dialogVisible = true;\n    },\n    save() {\n      if (this.cartData.length === 0) {\n        this.$notify.warning(\"您的购物车空空如也\");\n        return;\n      }\n      if (!this.addressId) {\n        this.$notify.warning(\"请选择收货地址,如没有地址，请到地址管理设置地址\");\n        return;\n      }\n      let data = {\n        list: this.cartData,\n        addressId: this.addressId\n      };\n      request.post(\"/order/buy\", data).then(res => {\n        if (res.code === '0') {\n          this.$notify.success(\"购买成功\");\n          this.$router.push(\"/front/order\");\n        } else {\n          this.$notify.error(res.msg);\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["request","data","goodsId","$route","query","id","user","JSON","parse","localStorage","getItem","cartData","goods","addressList","dialogVisible","addressId","mounted","load","loadAddress","methods","get","then","res","code","$notify","error","msg","del","delete","success","buy","save","length","warning","list","post","$router","push"],"sources":["src/views/front/Cart.vue"],"sourcesContent":["<template>\n  <div class=\"main-content\">\n    <div style=\"margin-top: 40px;padding: 0 260px\">\n      <div class=\"main-table-box\">\n        <div style=\"height: 50px; line-height: 50px; font-weight: bold; font-size: 20px;margin-bottom: 40px\">我的购物车</div>\n        <!-- 购物车表格 -->\n        <el-table style=\"width: 100%\" :data=\"cartData\" size=\"small\" strip header-cell-class-name=\"tableHeaderClass\" >\n          <!-- 商品图片列 -->\n          <el-table-column label=\"商品图片\" width=\"100px\">\n            <template v-slot=\"scope\">\n              <el-image :src=\"scope.row.img\" :preview-src-list=\"[scope.row.img]\" style=\"width: 60px; height: 60px; border-radius: 50%\"></el-image>\n            </template>\n          </el-table-column>\n\n          <!-- 商品名称列 -->\n          <el-table-column label=\"商品名称\" prop=\"goodsName\" width=\"400px\"></el-table-column>\n\n          <!-- 价格列 -->\n          <el-table-column label=\"价格\" prop=\"price\"></el-table-column>\n\n          <!-- 数量列 -->\n          <el-table-column label=\"数量\" prop=\"num\"></el-table-column>\n\n          <!-- 操作列 -->\n          <el-table-column label=\"操作\">\n            <template v-slot=\"scope\">\n              <el-popconfirm title=\"确定删除？\" @confirm=\"del(scope.row.id)\">\n                <el-button size=\"small\" type=\"danger\" slot=\"reference\">删除</el-button>\n              </el-popconfirm>\n            </template>\n          </el-table-column>\n        </el-table>\n        \n        <!-- 购买按钮 -->\n        <div style=\"margin-top: 100px; text-align: right; padding: 20px 60px\">\n          <div class=\"detail-fields-item overflowShow\" style=\"margin-top: 20px\">\n            <!-- 监听到点击按钮，调用buy方法 -->\n            <el-button style=\"margin-left: 5px;width: 200px;height: 60px;background-color: #365ec2;color: white\" @click=\"buy\">\n              <span style=\"font-size:16px;\">购买</span>\n            </el-button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 购买对话框 -->\n    <el-dialog title=\"请选择收货地址\" :visible.sync=\"dialogVisible\" width=\"40%\">\n      <el-form :model=\"goods\" label-position=\"right\" label-width=\"100px\" style=\"padding-right: 40px\">\n        <el-form-item>\n          <span style=\"font-size: 12px;color: #8c8a8a;  margin-right: 10px\">收货人</span>\n          <el-select size=\"small\" style=\"width: 80%\" placeholder=\"请选择收货人\" v-model=\"addressId\">\n            <el-option v-for=\"item in addressList\" :value=\"item.id\" :label=\"item.username\" :key=\"item.id\"></el-option>\n          </el-select>\n        </el-form-item>\n\n        <el-form-item>\n          <span style=\"font-size: 12px;color: #8c8a8a;  margin-right: 10px\">配送地址</span>\n          <el-select size=\"small\" style=\"width: 80%\" placeholder=\"请选择收货地址\" v-model=\"addressId\">\n            <el-option v-for=\"item in addressList\" :value=\"item.id\" :label=\"item.address\" :key=\"item.id\"></el-option>\n          </el-select>\n        </el-form-item>\n      </el-form>\n\n      <!-- 操作按钮 -->\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button size=\"small\" @click=\"dialogVisible = false\">取 消</el-button>\n        <!-- 监听到点击支付按钮，调用save方法处理 -->\n        <el-button size=\"small\"  @click=\"save\" style=\"background-color: #365ec2; color: white;\">支 付</el-button>\n      </div>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\nimport request from \"@/utils/request\";\n\nexport default {\n  data() {\n    let goodsId = this.$route.query.id // 从当前路由的查询参数中获取id并赋值\n    return {\n      user: JSON.parse(localStorage.getItem(\"user\") || {}),\n      cartData: [], // 购物车表格数据\n      goods: {},\n      goodsId: goodsId,\n      addressList: [],\n      dialogVisible: false, // 对话框是否可见\n      addressId: null,\n    }\n  },\n\n  // 加载时做的事情\n  mounted() {\n    this.load()\n    this.loadAddress()\n\n  },\n\n  // methods：本页面所有的点击事件或者其他函数定义区\n  methods: {\n    // 加载数据\n    load() {\n      request.get(\"/cart\").then(res => {\n        if (res.code === '0') {\n          this.cartData = res.data\n        } else {\n          this.$notify.error(res.msg)\n        }\n      })\n    },\n\n    // 根据id删除\n    del(id) {\n      request.delete(\"/cart/\" + id).then(res => {\n        if (res.code === '0') {\n          this.$notify.success(\"删除成功\")\n          this.load()\n        } else {\n          this.$notify.error(res.msg)\n        }\n      })\n    },\n    loadAddress(){\n      request.get(\"/address\").then(res => {\n        if (res.code === '0') {\n          this.addressList = res.data\n        } else {\n          this.$notify.error(res.msg)\n        }\n      })\n    },\n    buy() {\n      this.dialogVisible = true;\n    },\n    save() {\n      if (this.cartData.length === 0) {\n        this.$notify.warning(\"您的购物车空空如也\")\n        return\n      }\n      if (!this.addressId) {\n        this.$notify.warning(\"请选择收货地址,如没有地址，请到地址管理设置地址\")\n        return\n      }\n      let data = {list: this.cartData, addressId: this.addressId}\n      request.post(\"/order/buy\", data).then(res => {\n        if (res.code === '0') {\n          this.$notify.success(\"购买成功\")\n          this.$router.push(\"/front/order\")\n        } else {\n          this.$notify.error(res.msg)\n        }\n      })\n    }\n  }\n}\n</script>\n"],"mappings":";AA2EA,OAAAA,OAAA;AAEA;EACAC,KAAA;IACA,IAAAC,OAAA,QAAAC,MAAA,CAAAC,KAAA,CAAAC,EAAA;IACA;MACAC,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,QAAA;MAAA;MACAC,KAAA;MACAV,OAAA,EAAAA,OAAA;MACAW,WAAA;MACAC,aAAA;MAAA;MACAC,SAAA;IACA;EACA;EAEA;EACAC,QAAA;IACA,KAAAC,IAAA;IACA,KAAAC,WAAA;EAEA;EAEA;EACAC,OAAA;IACA;IACAF,KAAA;MACAjB,OAAA,CAAAoB,GAAA,UAAAC,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAZ,QAAA,GAAAW,GAAA,CAAArB,IAAA;QACA;UACA,KAAAuB,OAAA,CAAAC,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IAEA;IACAC,IAAAtB,EAAA;MACAL,OAAA,CAAA4B,MAAA,YAAAvB,EAAA,EAAAgB,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAC,OAAA,CAAAK,OAAA;UACA,KAAAZ,IAAA;QACA;UACA,KAAAO,OAAA,CAAAC,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IACAR,YAAA;MACAlB,OAAA,CAAAoB,GAAA,aAAAC,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAV,WAAA,GAAAS,GAAA,CAAArB,IAAA;QACA;UACA,KAAAuB,OAAA,CAAAC,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IACAI,IAAA;MACA,KAAAhB,aAAA;IACA;IACAiB,KAAA;MACA,SAAApB,QAAA,CAAAqB,MAAA;QACA,KAAAR,OAAA,CAAAS,OAAA;QACA;MACA;MACA,UAAAlB,SAAA;QACA,KAAAS,OAAA,CAAAS,OAAA;QACA;MACA;MACA,IAAAhC,IAAA;QAAAiC,IAAA,OAAAvB,QAAA;QAAAI,SAAA,OAAAA;MAAA;MACAf,OAAA,CAAAmC,IAAA,eAAAlC,IAAA,EAAAoB,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAC,OAAA,CAAAK,OAAA;UACA,KAAAO,OAAA,CAAAC,IAAA;QACA;UACA,KAAAb,OAAA,CAAAC,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}